<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js">
<!--<![endif]-->

<head>

    {% load static %}
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Smart HR &mdash; Foxconn Smart HR</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Foxconn Smart HR" />
    <meta name="author" content="Josua Ataansuyi" />



    <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
    <link rel="shortcut icon" href="{% static 'favicon.ico' %}">

    <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700" rel="stylesheet">

    <!-- Animate.css -->
    <link rel="stylesheet" href="{% static 'smart_hr/css/animate.css' %}">
    <!-- Icomoon Icon Fonts-->
    <link rel="stylesheet" href="{% static 'smart_hr/css/icomoon.css' %}">
    <!-- Bootstrap  -->
    <link rel="stylesheet" href="{% static 'smart_hr/css/bootstrap.css' %}">
    <!-- Flexslider  -->
    <link rel="stylesheet" href="{% static 'smart_hr/css/flexslider.css' %}">
    <!-- Theme style  -->
    <link rel="stylesheet" href="{% static 'smart_hr/css/style.css'%}">
    <!-- Fonts Awesome-->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"/>
    <!-- Toastr notification -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.min.css" rel="stylesheet"/>
    <!-- Jquery UI -->
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Modernizr JS -->
    <script src="{% static 'smart_hr/js1/modernizr-2.6.2.min.js' %}"></script>
    <!-- FOR IE9 below -->
    <!--[if lt IE 9]>
    <script src="{% static 'smart_hr/js/respond.min.js' %}"></script>
    <![endif]-->

    <style>
        .ui-autocomplete {
            max-height: 200px;
            overflow-y: auto;
            /* prevent horizontal scrollbar */
            overflow-x: hidden;
            /* add padding to account for vertical scrollbar */
            padding-right: 20px;
        }
        .loading {
            background: transparent url("{% static 'smart_hr/images/loading.gif' %}") center no-repeat;
            background-size: 25px 25px;
        }
        .required {
            color: indianred;
        }
    </style>

</head>

<body>
<div id="smart_hr_page">
    <a href="#" class="js-fh5co-nav-toggle fh5co-nav-toggle"><i></i></a>
    <aside id="fh5co-aside" role="complementary" class="border js-fullheight">
        <h5 class="text-center">Welcome, {{ request.session.full_name }}</h5>
        <h1 id="fh5co-logo"><a href="{% url 'smart_hr_home' %}">Smart HR (Foxconn)</a></h1>
        <nav id="fh5co-main-menu" role="navigation">
            <ul>
                <li><a href="{% url 'smart_office_dashboard' %}">Smart Office</a></li>
                {% if 'create_checklist' in request.session.user_perm  %}
                    <li><a href="{% url 'checklist_create' %}">Create New Checklist</a></li>
                {% endif %}
                <li class="fh5co-active"><a href="{% url 'checklist_list' %}">List All Checklist</a></li>
            </ul>
        </nav>

        <div class="fh5co-footer">
            <p><small>&copy; {% now "Y" %} Foxconn IT Software Development </span> </small></p>

        </div>

    </aside>
    <div id="fh5co-main">

        <div class="fh5co-narrow-content animate-box" data-animate-effect="fadeInLeft">

            <div class="row">
                <div class="col-md-12">
                    <h2>Edit Checklist Details</h2>
                </div>
            </div>

        </div>
        <div class="col-md-12">
            <label for="employee_name" class="control-label col-lg-12">Employee Name</label>
        </div>
        <div class="col-md-4">
            <div class="form-group">
                <input type="text" class="form-control" placeholder="First Name" id="first_name" name="first_name" value="{{ employee.firstName }}" readonly>
            </div>
        </div>
        <div class="col-md-4">
            <div class="form-group">
                <input type="text" class="form-control" placeholder="Middle Name" id="middle_name" name="middle_name" value="{{ employee.middleName }}" readonly>
            </div>
        </div>
        <div class="col-md-4">
            <div class="form-group">
                <input type="text" class="form-control" placeholder="Last Name" id="last_name" name="last_name" value="{{ employee.lastName }}" readonly>
            </div>
        </div>
        <div class="col-md-6">
            <label for="employee_email" class="control-label col-lg-6">Email Address</label>
            <div class="form-group">
                <input type="text" class="form-control" placeholder="Email Address" id="email" name="email" value="{{ employee.email }}" readonly>
            </div>
        </div>
        <div class="col-md-6">
            <label for="position" class="control-label col-lg-6">Position</label>
            <div class="form-group">
                <input type="text" class="form-control" placeholder="Position" id="position" name="position" value="{{ empdept.roleID.title}}" readonly>
            </div>
        </div>
        <div class="col-md-6">
            <label for="business_unit" class="control-label col-lg-6">Business Unit</label>
            <div class="form-group">
                <input type="text" class="form-control" placeholder="Business Unit" id="business_unit" name="business_unit" value="{{ empdept.departmentID.businessUnit.buName}}" readonly>
            </div>
        </div>
        <div class="col-md-6">
            <label for="phone_number" class="control-label col-lg-6">Department</label>
            <div class="form-group">
                <input type="tel" class="form-control" placeholder="Phone Number" id="phone_number" name="phone_number" value="{{ empdept.departmentID.costCenterName}}" readonly>
            </div>
        </div>

        <div class="col-md-6">
            <label for="department" class="control-label col-lg-6">Manager</label>
            <div class="form-group">
                <input type="text" class="form-control" placeholder="Manager" id="department" name="manager"
                       value="{{ empdept.managerID.firstName}} {% if empdept.managerID.middleName %} {{ empdept.managerID.middleName }}{{ " " }} {% endif %}{{ empdept.managerID.lastName }}" readonly>
            </div>
        </div>

        <div class="col-md-6">
            <label for="email" class="control-label col-lg-6">Cost Code</label>
            <div class="form-group">
                <input type="email" class="form-control" placeholder="Cost Code" id="email" name="email" readonly>
            </div>
        </div>

        <div class="col-md-6">
            <label for="business_unit" class="control-label col-lg-6">Hire Date</label>
            <div class="form-group">
                <input type="text" class="form-control" placeholder="Hire Date" id="hire_date" name="hire_date" value="{{ employee.doh }} " readonly>
            </div>
        </div>
        <form id="form" method="POST"> {% csrf_token %}
            <div class="col-md-12">
                <table class="table table-striped table-responsiv" id ="checklist">
                    <thead>
                    <tr>
                        <th class="col-md-6">TASK</th>
                        <th class="col-md-2">Department</th>
                        <th class="col-md-1">DUE DATE</th>
                        <th class="col-md-3">TASK ASSIGNEE <b class="required">*</b></th>
                        <th class="col-md-1">COMPLETED</th>
                    </tr>
                    </thead>
                    <tbody id="checklist">
                    {% for task in checklist %}
                        <tr>
                            <td class="col-md-6">{{ task.taskID.description }} {% if task.completed %} <br> <i style="color: mediumseagreen; font-size: small">Completed On: {{ task.dateCompleted }}</i> {% endif %}</td>
                            <td class="col-md-2">{{ task.taskID.department.costCenterName }}</td>
                            <td class="col-md-1"><input type="date" class="form-control" name="date_{{ task.taskID}}" value="{{ task.dueDate |date:"Y-m-d"}}"></td>
                            <td class="col-md-3"><input type="text" class="form-control taskAssignee" id="{{ task.taskID.department.costCenterCode }}" placeholder="Enter Employee Name" value="{{ task.taskAssignee }}" required></td>
                            <input type="hidden" name="assignee_{{ task.taskID }}" value="{{ task.taskAssignee.associateID }}">
                            <td class="col-md-1">
                                <input type="checkbox" style="height: 30px; width: 30px;" class="form-control" name="check_{{ task.taskID }}" {% if task.completed %} checked {% endif %} >
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            </div>
            <div class="col-md-4">
                <div class="form-group">
                    <input type="submit" class="btn btn-primary btn-md" value="Submit">
                </div>
            </div>
        </form>
    </div>
</div>
</div>


<!-- jQuery -->
<script src="{% static 'smart_hr/js1/jquery.min.js' %}"></script>
<!-- jQuery Easing -->
<script src="{% static 'smart_hr/js1/jquery.easing.1.3.js' %}"></script>
<!-- Bootstrap -->
<script src="{% static 'smart_hr/js1/bootstrap.min.js' %}"></script>
<!-- Waypoints -->
<script src="{% static 'smart_hr/js1/jquery.waypoints.min.js' %}"></script>
<!-- Flexslider -->
<script src="{% static 'smart_hr/js1/jquery.flexslider-min.js' %}"></script>
<!-- Google Map -->
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCefOgb1ZWqYtj7raVSmN4PL2WkTrc-KyA&sensor=false"></script>
<script src="{% static 'smart_hr/js1/google_map.js' %}"></script>
<!-- JqueryUI JS -->
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<!-- Bootbox -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootbox.js/5.4.0/bootbox.min.js"></script>
<!-- Toastr notification -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/js/toastr.min.js"></script>

<!-- MAIN JS -->
<script src="{% static 'smart_hr/js1/main.js' %}"></script>

<!-- Written by Zaawar Ejaz -->
<script>

    {# Load box when form is submitted #}
    $('#form').submit(function() {
        bootbox.dialog({
            message: '<p class="text-center mb-0"><i class="fa fa-spin fa-spinner"></i> Please wait we are submitting the form...</p>',
            closeButton: false
        });
    });

    {# Toastr Notification #}
    $(function() {
        toastr.options = {
            "positionClass": "toast-bottom-right",
            "timeOut": 10000,
            "preventDuplicates": true,
            "newestOnTop": true,
        };

        {% for message in messages %}
            toastr.{{ message.tags }}("{{ message }}");
        {% endfor %}
    });

    $.ui.autocomplete.prototype._renderItem = function (ul, item) {
        var t = String(item.label).replace(
            new RegExp(this.term, "gi"),
            "<strong>$&</strong>");
        return $("<li></li>")
            .data("item.autocomplete", item)
            .append("<div>" + t + "</div>")
            .appendTo(ul);
    };

    $('.taskAssignee').autocomplete({
        minLength: 0,
        source: function (request, response) {
            var department = this.element.attr('id');
            var employees = $.grep({{ employees | safe }}, function(item) {
                return item.department === department && item.label.toLowerCase().includes(request.term.toLowerCase());
            });
            response(employees)
        },
        select: function (event, ui) {
            event.preventDefault();
            $(this).val(ui.item.label);
            $(this).parent().next().val(ui.item.value);
        },
        change: function(event,ui){
            if(!ui.item) {
                bootbox.alert({
                    message: "You must select from the list.",
                    closeButton: false,
                    size: 'small'
                });
                $(this).val("");
                $(this).parent().next().val("");
            }
        }
    });

    {# Checkbox confirmation #}
    $(':checkbox').change(function() {
        checkbox = $(this);
        if($(this).prop('checked') === false) {
            bootbox.dialog({
                title: "Are you sure you want to uncheck?",
                size: 'small',
                buttons: {
                    cancel: {
                        label: "cancel",
                        callback: function(){
                            $(checkbox).prop('checked', true);
                        }
                    },
                    ok: {
                        label: "uncheck",
                        className: 'btn-info',
                        callback: function() {
                            $(checkbox).prop('checked', false);
                        }
                    }
                }
            })
        }
    });

    $('.taskAssignee').keydown(function(){
        $(this).addClass('loading');
    }).keyup(function(){
        $(this).removeClass('loading');
    }).focusout(function () {
        $(this).removeClass('loading');
    })
</script>
</body>

</html>
